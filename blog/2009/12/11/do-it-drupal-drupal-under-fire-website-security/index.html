
<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang='en-US' class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html -->
<title>Do It With Drupal: Drupal Under Fire: Website Security - Quinn Dombrowski</title>
<meta name="description" content="Your site is vulnerable (really, it is) GVS offers security review service for Drupal Bad things: abusing resources, stealing data, altering data  Abusing resources: ...">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Quinn Dombrowski">
<meta property="og:title" content="Do It With Drupal: Drupal Under Fire: Website Security">
<meta property="og:url" content="https://www.quinndombrowski.com/blog/2009/12/11/do-it-drupal-drupal-under-fire-website-security/">


  <meta property="og:description" content="Your site is vulnerable (really, it is) GVS offers security review service for Drupal Bad things: abusing resources, stealing data, altering data  Abusing resources: ...">



  <meta property="og:image" content="https://www.quinndombrowski.com">





  <meta property="article:published_time" content="2009-12-10T00:00:00+00:00">






<link rel="canonical" href="https://www.quinndombrowski.com/blog/2009/12/11/do-it-drupal-drupal-under-fire-website-security/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Quinn Dombrowski",
      "url": "https://www.quinndombrowski.com/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Quinn Dombrowski Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/styles/minimal-mistakes.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Quinn Dombrowski
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/cv/">CV</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/">Projects</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/">Blog</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      




<div id="main" role="main">
  


  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    
    
    <meta itemprop="datePublished" content="2009-12-10T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://www.quinndombrowski.com/blog/2009/12/11/do-it-drupal-drupal-under-fire-website-security/" class="u-url" itemprop="url">Do It With Drupal: Drupal Under Fire: Website Security</a>
          </h1>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <p>&lt;ul&gt;
&lt;li&gt;Your site is vulnerable (really, it is)&lt;/li&gt;
&lt;li&gt;GVS offers security review service for Drupal&lt;/li&gt;
&lt;li&gt;Bad things: abusing resources, stealing data, altering data
&lt;ul&gt;
&lt;li&gt;Abusing resources: DDOS (extorting money from site owner), using open relay in a mail sending module for spam&lt;/li&gt;
&lt;li&gt;Stealing data: from users (their passwords, e-mail address)&lt;/li&gt;
&lt;li&gt;Altering data: defacement&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;You don't hear about security vulnerabilities much; Drupal core mentions vulnerabilities (and updates) but not so much for modules&lt;/li&gt;
&lt;li&gt;Worry in a prioritized way&lt;/li&gt;
&lt;li&gt;Choose your strategy: stay ahead of the pack, or protect valuable assets?&lt;/li&gt;
&lt;li&gt;Attacks focus on sites that are out of date&lt;/li&gt;
&lt;li&gt;Know about releases, have a method to update your site, do it&lt;/li&gt;
&lt;li&gt;Look into Aegir if you're running multiple sites&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Configuration&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Available updates- settings, e-mail notifications when modules you use are updated&lt;/li&gt;
&lt;li&gt;Security review module: drupal.org/project/security_review&lt;/li&gt;
&lt;li&gt;Will show if your site is under attack with a SQL injection&lt;/li&gt;
&lt;li&gt;Part of security review: check off which roles are considered &quot;trusted&quot; - trust-checks and points out which permissions are bad to give to untrusted users&lt;/li&gt;
&lt;li&gt;Can skip some of the checks so they don't nag you (if this is on a dev server, and it's not relevant)&lt;/li&gt;
&lt;li&gt;There is a hook to be able to run additional checks, but not sure whether modules should be able to declare their things (do we trust module developers to come up with the right set of rules?)&lt;/li&gt;
&lt;li&gt;If there's something that can take an action on your site, accessible via a link - that could be a vulnerability (i.e. the &quot;turn off this check&quot; feature of the security module)&lt;/li&gt;
&lt;li&gt;Run it before you launch, after you make big config changes; could do it as a periodic check and e-mail the report. Is ok to have always-on for a live site though&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Vulnerabilities by type&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Announcements from drupal.org; most sites have custom modules, almost always have custom themes&lt;/li&gt;
&lt;li&gt;Analysis of one site: 3-4 vulnerabilities in Drupal core, 20 in contrib modules, 100 vulnerabilities in custom theme/modules (no one else is reviewing that stuff except for you)&lt;/li&gt;
&lt;li&gt;XSS (cross-site scripting) - one of the hardest to fix&lt;/li&gt;
&lt;li&gt;Access bypass - good ways to fix this&lt;/li&gt;
&lt;li&gt;Cross site referral forgeries&lt;/li&gt;
&lt;li&gt;SQL injection - easy to protect against, only getting easier&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;XSS&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Anything you can do XSS can do (better)&lt;/li&gt;
&lt;li&gt;XSS can change password for user 1&lt;/li&gt;
&lt;li&gt;Most people don't know they've been a victim of XSS; it's in your browser, browser just executes javascript, don't know until you try to log back in&lt;/li&gt;
&lt;li&gt;XSS tools exist to probe your network - even if your Drupal is on the intranet&lt;/li&gt;
&lt;li&gt;Automated tools are a great way to get started, but not all that valuable in actually identifying things (false positives, false negatives)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Insecure configuration of input formats&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Input formats and filters are confusing - people do what they need, and forget about it, and open themselves up to XSS&lt;/li&gt;
&lt;li&gt;Anonymous users: shouldn't be allowed to have more than one input format&lt;/li&gt;
&lt;li&gt;Filtered HTML is the right thing for untrusted roles&lt;/li&gt;
&lt;li&gt;To this day, WYSIWYG modules say &quot;give everyone access to full HTML and tinymce will just work&quot; - NO! DON'T DO THAT!&lt;/li&gt;
&lt;li&gt;Defaults are good: filtered HTML is a good thing&lt;/li&gt;
&lt;li&gt;It's tempting to add images, spans, divs, etc - but different browsers have different vulnerabilities that way&lt;/li&gt;
&lt;li&gt;There's a page on drupal.org that talks about what's safe to put in (there's some gray area - depends on your users and their browsers)&lt;/li&gt;
&lt;li&gt;Weights: HTML corrector needs to go last&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;XSS for Themers/Coders (and reviewers)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Browscap module: analyzes user agents for people who go to the site&lt;/li&gt;
&lt;li&gt;Firefox extension (default user agent) - used to be for Firefox to pretend to be IE, but now people use it for other things&lt;/li&gt;
&lt;li&gt;Hackers can take normal user agent and replace it with jQuery that will be sent as the user agent - PWNED&lt;/li&gt;
&lt;li&gt;Is there a module that will strip in javascript from the input box? - Filtered HTML does that&lt;/li&gt;
&lt;li&gt;You can strip the script, or you can escape it (so it shows up as harmless text)&lt;/li&gt;
&lt;li&gt;Filtered HTML also gets rid of attributes&lt;/li&gt;
&lt;li&gt;There's a module that says which attributes can come through on which tags - well, the admin screen for it is huge, the input format area is a problem because it's confusing, so do you want to add an even more confusing module?&lt;/li&gt;
&lt;li&gt;Themers: Read tpl.php and default implementations; rely on your module developer for variables that are ready to be printed (hook pre-process)&lt;/li&gt;
&lt;li&gt;Developers: where does the text come from, is there a way a user can change it, in what context is it being used?&lt;/li&gt;
&lt;li&gt;More is from the user than you think (user agents are from the user)&lt;/li&gt;
&lt;li&gt;Filtered HTML makes things safe for the browser context&lt;/li&gt;
&lt;li&gt;When data leaves Drupal and goes into MySQL - need to escape the data to make it safe for putting into the database&lt;/li&gt;
&lt;li&gt;Contexts: mail (some clients sorta support javascript, need to specify plaintext), database, web, server&lt;/li&gt;
&lt;li&gt;Take an hour: &lt;a href=&quot;http://acko.net/blog/safe-string-theory-for-the-web&quot;&gt;http://acko.net/blog/safe-string-theory-for-the-web&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Drupal philosophy: make things secure by default&lt;/li&gt;
&lt;li&gt;Escape variables using the checkplain function&lt;/li&gt;
&lt;li&gt;If your site is translatable, it's also probably secure&lt;/li&gt;
&lt;li&gt;If you're using the API properly, you probably don't need to worry about security (but it takes a while to learn how to use the API property)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Cross Site Request Forgeries (CSRF)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Taking an action without confirming the intent of that action&lt;/li&gt;
&lt;li&gt;User Protect module - makes it harder to delete user 1; protects anonymous user, user 1, can add other users&lt;/li&gt;
&lt;li&gt;Drupal's form API has protection from this - using links doesn't&lt;/li&gt;
&lt;li&gt;An anonymous user can insert an &quot;image&quot; (the browser goes to look for it, and if that &quot;image&quot; is the link for User Protect that deletes the protection for user 1, that's bad)&lt;/li&gt;
&lt;li&gt;In the case of User Protect, there's now a confirmation form - browser would just fetch confirmation form and throw that away-- requirement that you have to click on &quot;submit&quot; button would save you from anything bad happening&lt;/li&gt;
&lt;li&gt;If you really want to use links like User Protect does, create a token based on something unique to the site, the user, and the action (and validate the token when the action is requested)&lt;/li&gt;
&lt;li&gt;User session ID (unique key private to site, generated randomly at login) + form ID&lt;/li&gt;
&lt;li&gt;When the action is submitted, Drupal will validate that it's still there&lt;/li&gt;
&lt;li&gt;Is it possible to give permissions to manage everything EXCEPT user 1? - that's what User Protect does&lt;/li&gt;
&lt;li&gt;Or, just use the form API - it includes this protection by default&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Security and usability&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Confirmation forms suck&lt;/li&gt;
&lt;li&gt;BUT, truly destructive actions &lt;strong&gt;should&lt;/strong&gt; be hard to do&lt;/li&gt;
&lt;li&gt;Don't delete, archive and provide undo&lt;/li&gt;
&lt;li&gt;Choose links or forms for usability, not security&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Resources&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;drupal.org/security-team&lt;/li&gt;
&lt;li&gt;drupal.org/security&lt;/li&gt;
&lt;li&gt;drupal.org/writing-secure-code&lt;/li&gt;
&lt;li&gt;drupal.org/security/secure-configuration&lt;/li&gt;
&lt;li&gt;heine.familiedeelstra.com&lt;/li&gt;
&lt;li&gt;crackingdrupal.com&lt;/li&gt;
&lt;li&gt;crackingdrupal.com/node/34 - XSS Cheat Sheet&lt;/li&gt;
&lt;li&gt;crackingdrupal.com/node/48 - CSRF&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Questions&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Rainbow tables - MD5 values for every possible password up to 6 characters&lt;/li&gt;
&lt;li&gt;crackingdrupal.com - has resources including list of security modules (Salt module has salting of passwords)&lt;/li&gt;
&lt;li&gt;Any way to hide you're running Drupal? - data in the CSS files, standard Drupal jQuery, a few files in the root directory, expiration date for anonymous is Dries's birthday; there's all sorts of things that fingerprint a Drupal site, trying to hide you're running Drupal takes more time than it's worth if you just keep up with updates&lt;/li&gt;
&lt;li&gt;
&lt;/li&gt;
&lt;/ul&gt;</p>

        
      </section>

      <footer class="page__meta">
        
        


        <!---->

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2009-12-10T00:00:00+00:00">December 10th 2009</time></p>

      </footer>

      

      
    </div>

   
  </article>

  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Quinn Dombrowski. Powered by <a href="https://www.11ty.dev/" rel="nofollow">Eleventy</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a> (adapted as <a href="https://github.com/quinnanya/eleven-mistakes">Eleven Mistakes</a>).
<p>Also on <a rel="me" href="https://mstdn.social/@quinnanya">Mastodon</a></p>
</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>









  </body>
</html>
